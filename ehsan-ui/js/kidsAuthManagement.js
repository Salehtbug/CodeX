import{J as e}from"./justvalidation.js";let t=document.querySelectorAll(".open-account");null==t||t.forEach((e=>{e.addEventListener("click",(()=>{let t=new bootstrap.Modal("#kidsLoginUsePinCodeModal"),n=e.dataset.id;fetch(`/kids/KidAccountLogin?kidId=${n}`,{method:"POST",headers:{"Content-Type":"application/json"},async:!1}).then((e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()})).then((e=>{e.isSuccess&&(e.isLoggedIn?window.location.href="/kids":(t.show(),o.dataset.id=n))})).catch((e=>{console.error("There was an error with the fetch operation:",e)}))}))}));const o=document.getElementById("validateCodPinForKids");let n=document.querySelectorAll(".verification-inputs input");o&&o.addEventListener("click",(e=>{e.preventDefault();let t=!0;const o=document.getElementById("otpErrorMsgForKids");if(n.forEach((e=>{""==e.value||null==e.value?(e.classList.add("border-danger"),e.classList.remove("border-primary-green","valid"),t=!1):(e.classList.remove("border-danger"),e.classList.add("border-primary-green","valid"))})),t){let t="";n.forEach((e=>{t+=e.value}));let d={Pincode:t,Id:e.target.dataset.id};fetch("/Kids/ValidateKidPincode",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d),async:!1}).then((e=>e.json())).then((e=>{e.isSuccess?window.location.href=e.result:o.textContent=e.result})).catch((e=>{console.log(e)}))}}));const d=document.getElementById("closeKidsLoginUsePinCodeModal");null==d||d.addEventListener("click",(()=>{n.forEach((e=>{e.value="",e.classList.remove("border-danger","border-primary-green","valid")}))}));const r=document.getElementById("kidsLoginBtn"),s=document.getElementById("kidsLogInForm"),a=document.getElementById("PhoneNumber"),l=document.getElementById("kidsPhoneNumber"),i=document.getElementById("kidsValidateOTPWrapper"),c=document.getElementById("kidsLoginWrapper");let u="";s&&(u=new e("#kidsLogInForm",{validateBeforeSubmitting:!0})),null==r||r.addEventListener("click",(function(e){u.addField("#PhoneNumber",[{rule:"required",errorMessage:"الحقل مطلوب"},{rule:"maxLength",value:10,errorMessage:"يجب ألا يتجاوز الطول 10 أرقام"},{rule:"minLength",value:10,errorMessage:"يجب ألا يقل الطول عن 10 أرقام"},{rule:"number",errorMessage:"يجب أن يكون المدخل رقم فقط"},{rule:"customRegexp",value:/(009665|9665|\+9665|05|5)/,errorMessage:"يجب أن يبدأ الرقم ب 05"}]).onSuccess((e=>{let t=a.value;fetch(`/kids/guardianlogin?PhoneNumber=${t}`,{method:"POST"}).then((e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()})).then((e=>{e.isSuccess?(i.classList.remove("d-none"),i.querySelectorAll(".otp-input").forEach((e=>{e.value=""})),c.classList.add("d-none"),l.value=t):new bootstrap.Modal("#invalidMobileNumberModal").show()})).catch((e=>{console.error("There was an error with the fetch operation:",e)}))})).onFail((e=>{}))})),document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelectorAll(".otp-input"),t=document.getElementById("GuardianOtp");function o(e){1===e.value.length?e.classList.add("filled"):e.classList.remove("filled")}function n(){const o=Array.from(e).map((e=>e.value)).join("");t.value=o,console.log("Collected OTP:",o)}function o(e){1===e.value.length?(e.classList.remove("border-danger"),e.classList.add("border-primary-green")):(e.classList.remove("border-primary-green"),e.classList.add("border-danger"))}function n(){let o="";e.forEach((e=>{o+=e.value})),t&&(t.value=o)}e.forEach(((t,d)=>{t.addEventListener("keydown",(e=>{-1!==[46,8,9,27,13].indexOf(e.keyCode)||65===e.keyCode&&(!0===e.ctrlKey||!0===e.metaKey)||e.keyCode>=35&&e.keyCode<=40||(e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()})),t.addEventListener("keyup",(r=>{1===t.value.length&&d<e.length-1&&e[d+1].focus(),o(t),n()})),t.addEventListener("input",(e=>{0===t.value.length&&(o(t),n())}))}))}));const m=document.getElementById("validateOTPBtn"),h=document.getElementById("notExistKidsModal");let g="";h&&(g=new bootstrap.Modal("#notExistKidsModal")),null==m||m.addEventListener("click",(e=>{e.preventDefault();const t=document.getElementById("kidsPhoneNumber").value,o=document.getElementById("GuardianOtp").value,n=document.getElementById("otpErrors");let d={GuardianOtp:o,PhoneNumber:t};fetch("/Kids/ValidateOtp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d),async:!1}).then((e=>e.json())).then((e=>{e.isSuccess?fetch("/Kids/ValidateKidsAccounts",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{e.isSuccess?window.location.href=e.result:console.log(e)})):(null==e.hasKids||e.hasKids||g.show(),null==e.otpCorrect||e.otpCorrect||(n.classList.remove("d-none"),n.textContent="الرمز المدخل غير صحيح"))})).catch((e=>{console.log(e)}))}));const p=document.getElementById("kidsSignOut");null==p||p.addEventListener("click",(e=>{e.preventDefault(),localStorage.setItem("kidsopportunitiesList",""),window.location.href="/kids/logout"}));const v=document.getElementById("checkIfShowModal");v&&"True"==v.dataset.show&&g.show();
//# sourceMappingURL=kidsAuthManagement.js.map
