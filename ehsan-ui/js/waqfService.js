import{a as e}from"./axios.js";import{J as t}from"./justvalidation.js";import{M as n}from"./bootstrap.js";import"./otp.js";import{i as a}from"./countryCodeModule.js";import{r as o}from"./replaceArabicNumerals.js";import"./tom-select.complete.js";const l=document.getElementById("certificate-preview"),i=document.getElementById("smsImagePreview"),d=document.getElementById("loader"),r=()=>{d.classList.remove("d-none"),l.classList.add("d-none"),document.querySelector("input[name='WaqfDonationDto.IsGift']").checked?(i.src="/assets/images/waqf/waqf-gift-sms.jpg",i.alt="جهاز آيفون بأطراف رمادية، تظهر على شاشته البيضاء رسالة نصية. يوجد في منتصف الشاشة صورة مُستخدم افتراضية وتحتها كُتب اسم المرسل: (Ehsan)، تحته مربع رمادي فاتح منحني الأطراف، كُُتِب داخله بالأسود: أهلاً (اسم المهدي). محبة لك وإحساناً إليك، أقدم لك هدية يدوم أثرها ويبقى أجرها عبر وقف إحسان. من: (اسم المرسل). رابط شهادة الوقف: رابط الشهادة بلون أزرق وخط تحت السطر. وفي أسفل منتصف الشاشة مربع فارغ لكتابة الرد، على يمينه أيقونة الإرسال الخضراء وعلى يساره أيقونة كاميرا رمادية.",name="اسم المهدى إليه"):(i.src="/assets/images/waqf/sms-waqf.png",i.alt='جهاز آيفون بأطراف رمادية، تظهر على شاشته البيضاء رسالة نصية. يوجد في منتصف الشاشة صورة مُستخدم افتراضية وتحتها كُتب اسم المرسل: (Ehsan)، تحته مربع رمادي فاتح منحني الأطراف، كُُتِب داخله بالأسود: "وقف يدوم أجره، ويعمّ أثره. شكر الله كريم مساهمتك في صندوق إحسان الوقفي. يمكنك الاطلاع على شهادتك الوقفية عبر الرابط الآتي." كُتِبَ تحتها رابط الشهادة بلون أزرق وخط تحت السطر. وكُتِب تحته عبارة "جزاك الله بالإحسان إحساناً." وفي أسفل منتصف الشاشة مربع فارغ لكتابة الرد، على يمينه أيقونة الإرسال الخضراء وعلى يساره أيقونة كاميرا رمادية.',name="اسم الواقف"),e.get(`waqf/CertificatePreview?isGift=${document.querySelector("input[name='WaqfDonationDto.IsGift']").checked}`).then((e=>{l.src="data:image/jpg;base64,"+e.data.image,l.alt=e.data.alt,d.classList.add("d-none"),l.classList.remove("d-none")})).catch((e=>{l.src="/assets/images/waqf/waqf-certificate.jpg",d.classList.add("d-none")}))};r(),document.getElementById("showCertificateModal").addEventListener("show.bs.modal",(e=>{r()}));const s=document.getElementById("validateMobileNumberInGift");let c=document.getElementById("msgLimitationError");const u=document.getElementById("submit-details"),m=document.getElementById("saveBtn"),v=document.getElementById("closeValidationMobileModal");let f="",b="",y=document.getElementById("validateMobileNumberModal"),g="";const p=document.getElementById("validateOtp");let h=document.querySelector(".verification-inputs-otp"),q=null==h?void 0:h.querySelectorAll(".otp"),S=document.getElementById("otpErrorMsg");const E=!!(null==s?void 0:s.dataset.url);let L="/gift/SendOtp/";m&&"True"==m.dataset.disabled?(m.disabled=!1,m.classList.remove("d-none")):m&&"False"==m.dataset.disabled&&(m.disabled=!0,m.classList.add("d-none"));let I=document.querySelector("#mobileNumberContainer .country-code");y&&(g=new n(y)),E?I.addEventListener("change",(function(e){document.getElementById("validateMobileNumberSuccess").classList.add("d-none"),"1"==I.value?(m.disabled=!0,m.classList.add("d-none"),s.classList.remove("d-none")):(m.disabled=!1,m.classList.remove("d-none"),s.classList.add("d-none"))})):I&&(I.disabled=!0),null==s||s.addEventListener("click",(function(e){e.preventDefault();let t=document.getElementById("SenderName");b=t.value;let n=document.getElementById("mobileNumberContainer").querySelector(".input-gifteeNumber"),a=document.getElementById("SenderNameErr"),o=document.getElementById("mobileNumberErr");if(n.addEventListener("input",(function(){document.getElementById("validateMobileNumberSuccess").classList.add("d-none"),o.classList.add("d-none"),"1"==I.value&&(s.disabled=!1,s.classList.remove("d-none"),m&&(m.disabled=!0,m.classList.add("d-none")),u&&(u.disabled=!0),s.dataset.validate=!1,c.textContent="")})),t.addEventListener("input",(function(){document.getElementById("validateMobileNumberSuccess").classList.add("d-none"),a.classList.add("d-none"),"1"==I.value&&(s.disabled=!1,s.classList.remove("d-none"),m&&(m.disabled=!0,m.classList.add("d-none")),u&&(u.disabled=!0),s.dataset.validate=!1,c.textContent="")})),b.trim().length>1&&n.value&&!n.classList.contains("error")){let e=document.getElementById("SenderNameErrSyn"),t=I.value;if(/[\?\*\]\[{}\\|~]/.test(b)||/[^a-zA-Z0-9\u0600-\u06FF\s]/.test(b))return e.classList.remove("d-none"),!1;if(e.classList.add("d-none"),!/^(5)[0-9]/.test(n.value)||9!=n.value.length)return c.textContent="رقم جوال غير صحيح",!1;c.textContent="";let a=t.match(/\d+/);a&&a[0],f="0"+n.value,this.disabled=!0,E&&(L=s.dataset.url),fetch(L+f,{method:"POST",headers:{"Content-Type":"application/json"},async:!1}).then((function(e){return e.json()})).then((function(e){e.isSuccess?(g.show(),document.getElementById("mobile-number").innerText=f.slice(-4),setTimeout((()=>{document.getElementById("code1").focus()}),1e3)):c.textContent=e.result})).catch((function(e){alert("حدث خطأ أثناء إرسال الرسالة")}))}else b.trim().length<=1?a.classList.remove("d-none"):a.classList.add("d-none"),n.value||o.classList.remove("d-none")})),null==p||p.addEventListener("click",(function(e){e.preventDefault();let t="";if(q.forEach((e=>{""!=e.value&&null!=e.value&&e.value||(e.classList.add("border-danger"),e.classList.remove("border-primary-green","valid"),S.textContent="",S.classList.add("d-none")),t+=e.value})),""!==t&&6===t.length){let e=b;this.disabled=!0,S.textContent="",S.classList.add("d-none");let n={mobileNumber:f,code:t,fullName:e};fetch("/gift/ValidateOtp/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),async:!1}).then((e=>e.json())).then((e=>{e.isSuccess?(g.hide(),document.getElementById("validateMobileNumberSuccess").classList.remove("d-none"),E&&(document.querySelector("main").dataset.createrId=e.result),u&&(u.disabled=!1),m&&(m.disabled=!1,m.classList.remove("d-none")),this.disabled=!1,q.forEach((e=>{e.value="",e.classList.remove("border-primary-green","valid")})),s.dataset.validate=!0,s.classList.add("d-none")):(S.textContent=e.result,S.classList.remove("d-none"),this.disabled=!1,s.dataset.validate=!1)})).catch((e=>{this.disabled=!1,this.dataset.validate=!1;document.getElementById("divOtp").querySelector(".field-validation-valid").textContent="حدث خطأ أثناء التحقق من الرمز"}))}})),document.querySelectorAll(".verification-inputs-otp input").forEach((function(e){e.addEventListener("keyup",(function(t){var n;if(8!=t.keyCode){if(""!==t.currentTarget.value){var a=e.nextElementSibling;if(a&&"input"===a.tagName.toLowerCase())a.focus();else{const e=document.querySelector("#validateOtp"),t=document.querySelector("#kidsValidateOtp");e&&(e.disabled=!1,e.focus()),t&&(t.disabled=!1,t.focus()),null==(n=document.querySelector("#validateOtpForRefundBtn"))||n.focus()}e.classList.add("border-primary-green","border-2")}}else{var o=e.previousElementSibling;o&&"input"===o.tagName.toLowerCase()&&(o.focus(),e.classList.remove("border-primary-green","border-2"))}}))})),null==v||v.addEventListener("click",(function(){q.forEach((e=>{e.value="",e.classList.remove("border-primary-green","valid","border-danger")})),s&&(s.disabled=!1);const e=document.getElementById("refundAnonymosSubmitBtn");e&&(e.disabled=!1),S.textContent="",S.classList.add("d-none")}));const x=document.getElementById("srNotificationArea"),B=document.getElementById("organizations-select"),N=document.getElementById("project-type-select"),A=document.getElementById("regions-select"),D=new URLSearchParams(window.location.search),$=document.getElementById("quantity"),k=document.getElementById("quantitySrSpan"),w=$.dataset.price,C=document.getElementById("waqf-amount"),W=document.getElementById("decrease-button"),T=document.getElementById("increase-button"),G=document.querySelector("#numberOfVisits"),M=document.getElementById("saveBtn"),z=document.getElementById("validateMobileNumberInGift"),j=document.getElementById("sender-info-section"),F=document.getElementById("sender-name-label"),O=document.getElementById("SenderName"),P=document.querySelector("input[name='WaqfDonationDto.WantCertificate']"),V=document.querySelector("input[name='WaqfDonationDto.IsGift']"),Q=document.querySelector("#giftee-container"),H=document.querySelector("#donate-container"),R=document.querySelector("#giftee-list"),J=document.querySelector("#addGiftee"),_=document.getElementById("mobileNumberContainer"),U=document.querySelector("#want-certificate"),Z=document.getElementById("alert-error"),K=document.getElementById("alert-error-modal"),X=document.getElementById("advanced-customization-itemes"),Y=document.getElementById("amount-customization"),ee=document.getElementById("stock-customization"),te=document.getElementById("all"),ne=document.getElementById("total-donation-number"),ae=document.getElementById("total-donation-summary"),oe=document.getElementById("add-advanced-customization"),le=new n("#customization-model",{keyboard:!1}),{caseId:ie,initiativeType:de}=document.getElementById("maincontent").dataset;e.get(`/visit-count/${de}/${ie}`).then((e=>{G.innerText=e.data||0})),Q.addEventListener("input",(function(e){if(e.target.classList.contains("mobile-number")){let t=e.target.value.replace(/[^0-9\u0660-\u0669]/g,"");e.target.value=o(t)}})),a([document.querySelector("#mobileNumberContainer > .mobile-container >.country-code")]);const re=new t("#details_donation",{validateBeforeSubmitting:!0}),se=(e="الحقل مطلوب")=>({rule:"required",errorMessage:e}),ce=(e,t)=>({rule:"customRegexp",value:e,errorMessage:t}),ue=(e,t)=>({rule:"minLength",value:e,errorMessage:t});var me,ve;re.addField("#waqf-amount",[(me=parseInt(saveBtn.dataset.remaining),ve=`لا يمكن التبرع بمبلغ أكبر من ${saveBtn.dataset.remaining} ريال سعودي`,{rule:"maxNumber",value:me,errorMessage:ve})],{errorsContainer:"#donate-error"});const fe=e=>{e<=1?W.disabled=!0:!V.checked&&all.checked&&(W.disabled=!1),$.value=e,C.value=$.value*w,ne.innerText=C.value,k.innerText=`عدد الوحدات: ${$.value}`,all.checked&&re.revalidateField("#waqf-amount")};fe($.value),B.tomselect.clear(),N.tomselect.clear(),A.tomselect.clear();$.addEventListener("keyup",(()=>{$.value=null!=$.value&&$.value>0?$.value:1,fe($.value)})),C.addEventListener("change",(()=>{C.value=Number(C.value)>0?C.value:w;const e=Math.ceil(C.value/w);fe(e)})),C.addEventListener("input",(()=>{!Number(C.value)>0&&fe($.value)})),W.addEventListener("click",(()=>{var e;e=parseInt($.value,10),e=isNaN(e)?1:e,e--,fe(e)})),T.addEventListener("click",(()=>{var e;e=parseInt($.value,10),e=isNaN(e)?1:e,e++,fe(e)}));const be=(e,t,n=!0)=>{F.innerText=t,O.setAttribute("placeholder",t),e.disabled=n,e.value=!1,e.checked=!1},ye=(e,t)=>{e.forEach((e=>{e.disabled=t}))};document.querySelectorAll(".toggle-sender-info").forEach((e=>{e.addEventListener("change",(e=>{var t;e.target.checked?(null==_&&re.addField("#SenderName",[se()],{errorsContainer:"#sender-name-error"}),e.target.value=!0,z&&(z.classList.remove("d-none"),M.classList.add("d-none")),"WaqfDonationDto.IsGift"==e.target.name&&(te.click(),$e(),U.classList.add("d-none"),be(P,"اسم المرسل"),ye([$,C,T,W],!0),Ie(!0),Q.classList.remove("d-none"),H.classList.add("disabled"),H.setAttribute("aria-hidden","true"),H.querySelectorAll("input,select,button").forEach((e=>e.setAttribute("tabindex","-1")))),j.style.display="block","true"==(null==z?void 0:z.dataset.validate)?(z.classList.add("d-none"),M.classList.remove("d-none")):"1"==(null==(t=document.querySelector("#mobileNumberContainer > .mobile-container  >.country-code"))?void 0:t.value)?(saveBtn.disabled=!0,saveBtn.classList.add("d-none"),null==z||z.classList.remove("d-none")):(saveBtn.disabled=!1,saveBtn.classList.remove("d-none"),null==z||z.classList.add("d-none"))):(U.classList.remove("d-none"),H.classList.remove("disabled"),H.removeAttribute("aria-hidden"),H.querySelectorAll("input,select,button").forEach((e=>e.removeAttribute("tabindex"))),ye([$,C,T],!1),fe(10),$.value>1&&(W.disabled=!1),null==_&&re.removeField("#SenderName"),e.target.value=!1,P.disabled=!1,M.disabled=!1,null==z||z.classList.add("d-none"),M.classList.remove("d-none"),j.classList.add("sender-info-section"),j.style.display="none","WaqfDonationDto.IsGift"==e.target.name&&(Ie(!1),Q.classList.add("d-none")),be(V,"اسم المرسل",!1),be(P,"الاسم على شهادة الوقف",!1))}))})),D.get("org")&&""!=D.get("org")&&(document.getElementById("organization").checked=!0,"-1"!=B.dataset.selected&&B.tomselect.addItem(B.dataset.selected));const ge=(e,t)=>{t.querySelector(".error-text").textContent=e},pe=(e,t)=>{switch(e.id){case"project-type":return""==N.value&&""==A.value?(ge("عند تخصيص المساهمة لمجال او منطقة يجب اختيار احدهما لاتمام التبرع.",t),t.classList.remove("d-none"),!1):(t.classList.add("d-none"),!0);case"organization":return""==B.value?(ge("عند تخصيص المساهمة لجمعية معينة يشترط اختيار جمعية لاتمام التبرع.",t),t.classList.remove("d-none"),!1):(t.classList.add("d-none"),!0);case"all":return t.classList.add("d-none"),!0;case"advanced-customization":return 0==document.querySelectorAll(".advanced-customization-item").length?(ge("الرجاء إضافة مساهمة واحدة أو اكثر.",t),t.classList.remove("d-none"),!1):(t.classList.add("d-none"),!0)}},he=()=>{document.querySelectorAll("input[name='WaqfDonationDto.WaqfAllocationType']").forEach((e=>{e.addEventListener("change",(e=>{if("0"==e.target.value){if("true"==V.value){V.click();document.querySelectorAll(".gifteeBoxDetails").forEach((e=>{0!=e.dataset.id&&document.getElementById(`gifteeBoxDetails-${e.dataset.id}`).remove()}))}fe(0),ae.classList.remove("d-none"),ye([$,C,T,W],!0),H.classList.add("disabled"),H.setAttribute("aria-hidden","true"),H.querySelectorAll("input,select,button").forEach((e=>e.setAttribute("tabindex","-1")))}else{Z.classList.add("d-none"),ae.classList.add("d-none");document.querySelectorAll(".advanced-customization-item").forEach((e=>{deleteCustomization(e.dataset.index)})),ye([$,C,T,W],!1),H.classList.remove("disabled"),H.removeAttribute("aria-hidden"),H.querySelectorAll("input,select,button").forEach((e=>e.removeAttribute("tabindex"))),fe(10)}}))}))};document.getElementById("details_donation").addEventListener("submit",(e=>{pe(document.querySelector("input[name='WaqfDonationDto.WaqfAllocationType']:checked"),Z)||e.preventDefault()})),re.onSuccess((t=>{if(pe(document.querySelector("input[name='WaqfDonationDto.WaqfAllocationType']:checked"),Z)){M.disabled=!0;let t=null,n=null;all.checked?V.checked?n=Ae():t=[{WaqfAllocationType:1,Stocks:parseInt($.value),Amount:parseInt(C.value),WaqfProjectId:null,RegionId:null,WaqfOrganizationId:null}]:t=De(),document.getElementById("phone-number").value=document.querySelector("#mobileNumberContainer > .mobile-container  > .input-gifteeNumber")?document.querySelector("#mobileNumberContainer > .mobile-container  .input-gifteeNumber").value:"",document.getElementById("phone-country-code").value=document.querySelector("#mobileNumberContainer > .mobile-container   .country-code")?document.querySelector(" #mobileNumberContainer > .mobile-container   .country-code").value:"",document.querySelector("input[name='WaqfDonationDto.CreatorId']").value=document.getElementById("maincontent").dataset.createrId;const a={WaqfId:Number(document.querySelector("input[name='WaqfDonationDto.WaqfId']").value),WaqfName:document.querySelector("input[name='WaqfDonationDto.WaqfName']").value,StockPrice:parseInt(document.querySelector("input[name='WaqfDonationDto.StockPrice']").value),WaqfDonationAllocations:t,WantCertificate:P.checked,UserId:""!=document.querySelector("input[name='WaqfDonationDto.CreatorId']").value?document.querySelector("input[name='WaqfDonationDto.CreatorId']").value:null,Name:O.value,PhoneNumber:{CountryCode:V.checked||P.checked?document.querySelector("input[name='WaqfDonationDto.PhoneNumber.CountryCode']").value:"",Number:document.querySelector("input[name='WaqfDonationDto.PhoneNumber.Number']").value},IsGift:V.checked,Gift:n};e({method:"post",url:"/waqf/Donate",data:a,headers:{"Content-Type":"application/json","x-antiforgery-token":document.getElementsByName("__RequestVerificationToken")[0].value}}).then((e=>{e.data&&(window.location.href=e.data.redirectToUrl)})).catch((e=>{M.disabled=!1}))}else he()})).onFail((e=>{pe(document.querySelector("input[name='WaqfDonationDto.WaqfAllocationType']:checked"),Z)}));let qe=0;function Se(e,t){e.value=Number(t.value)*Number(w),te.checked&&($e(),fe(t.value))}window.increaseValue=function(e){const t=e.closest(".row").querySelector(".calcQuantity"),n=t.closest(".row").querySelector(".calcAmount");t.value=Number(t.value)+1,Se(n,t)},window.decreaseValue=function(e){const t=e.closest(".row").querySelector(".calcQuantity"),n=t.closest(".row").querySelector(".calcAmount");t.value=t.value<=1?1:Number(t.value)-1,Se(n,t)},window.handleAnotherAmount=function(e){null!=e.value&&Number(e.value)>0||(e.value=w),changeAmount(e)},window.changeAmount=function(e){const t=e.closest(".row").querySelector(".calcQuantity");t.value=Math.ceil(e.value/w),Se(e,t)},window.changeQuantity=function(e){null!=e.value&&e.value>0?e.value=Math.ceil(e.value):e.value=1,Se(e.closest(".row").querySelector(".AnotherAmountAdd"),e),te.checked&&fe($.value)};const Ee=e=>{if(!e.currentTarget.classList.contains("gifteeBoxDetails")||!e.target.classList.contains("input-gifteeName"))return;let t=e.currentTarget,n=t.querySelector(".input-gifteeName"),a=t.querySelector(".gifteeSrTitle"),o=t.querySelector("button.removeGiftee");n.value.trim().length>0?(t.ariaLabel=`بيانات ${n.value}`,a.ariaLabel=`بيانات ${n.value}`,null!=o&&(o.ariaLabel=`حذف ${n.value}`)):(t.ariaLabel="بيانات المُتَبَرَّع عنه",a.ariaLabel="بيانات المُتَبَرَّع عنه",null!=o&&(o.ariaLabel="حذف"))};window.removeGiftee=e=>{Be(e),document.querySelector(`[data-id="${e}"]`).removeEventListener("input",Ee),document.getElementById(`gifteeBoxDetails-${e}`).remove(),$e(),J.removeAttribute("disabled"),J.focus(),x.innerHTML=`تم حذف العنصر من قائمة المُتَبَرَّع عنهم. (${document.querySelectorAll(".gifteeBoxDetails").length} / 5)`};const Le=()=>{fetch("/gift/GetCountryCodePartialView").then((e=>e.text())).then((e=>{const t=`<div class="bg-neutral-s border-rounded-10 gifteeBoxDetails mt-2 py-1 px-2 rounded-4" data-id="${qe}" id="gifteeBoxDetails-${qe}" role="group" aria-label="بيانات المُتَبَرَّع عنه">\n            <h4 class="visually-hidden gifteeSrTitle">بيانات المُتَبَرَّع عنه</h4>\n             ${0!==qe?`<button type="button" onclick="removeGiftee(${qe})" class="btn p-0 d-block ms-auto text-primary-darksky removeGiftee removeGiftee-${qe}"  data-id="${qe}" aria-label="حذف"><img class="w-10px" src="/ehsan-ui/images/icons-collections/close-icon.svg" alt""/></button>`:""}\n            <div class="row mb-3">\n                <div class="col-12">\n                  <div class="form-group">\n                    <label class="col-form-label text-primary-blue font-bold fs-12px" for="GifteeName-${qe}">تبرع عن <span class="text-error-7">*</span></label>\n                    <input type="text" class="input-gifteeName form-control payment-input" data-checkname="true" name="WaqfDonationDto.Gift[${qe}].GifteeName" id="GifteeName-${qe}" maxlength="50" placeholder="اسم المتبرع عنه">\n                  </div>\n                  <span class="text-danger fs-12px font-ehsan-semibold" id="GifteeName-${qe}-error"></span>\n                </div>\n                <div class="col-12">\n                  <div class="form-group">\n                      <label class="col-form-label text-primary-blue font-bold fs-12px" for="GifteeMobileNumber-${qe}">رقم الجوال <span class="text-error-7">*</span></label>\n                      ${e}\n                      <input type="hidden" class="gifteeNumber" name="WaqfDonationDto.Gift[${qe}].GifteeMobile" value="" />\n                      </div>\n                  <span class="text-danger fs-12px font-ehsan-semibold" id="GifteeMobileNumber-${qe}-error"></span>\n                </div>\n                  </div>\n                    <h5 class="visually-hidden">العدد</h5>\n                    <div class="mb-3" role="group" aria-label="العدد">\n                        <div class="d-flex amountsContainer row">\n                            <div class="align-items-end d-flex w-100">\n                                  <div class="form-group" role="group" aria-label="التبرع بالوحدات">\n                                      <label class="fs-12px mb-1" aria-level="3">عدد الوحدات</label>\n                                      <div class="d-flex">\n                                        <button class="btn btn-outline-secondary" type="button" onclick="increaseValue(this)" aria-label="إضافة وحدة"><img alt="" src="/ehsan-ui/images/icons-collections/input/plus-icon.svg"/></button>\n                                        <input onkeyup="changeQuantity(this)" type="number" inputmode="numeric" pattern="d*" maxlength="7" name="WaqfDonationDto.Gift[${qe}].Stocks" value="1" class="border-rounded form-control fs-14px mx-1 only-number text-center w-50px calcQuantity" aria-label="عدد الوحدات"/>\n                                        <button class="btn btn-outline-secondary" type="button" onclick="decreaseValue(this)" aria-label="إزالة وحدة"><img alt="" src="/ehsan-ui/images/icons-collections/input/menos-icon.svg"/></button>\n                                        <span class="visually-hidden" aria-live="polite" aria-atomic="true"></span>\n                                      </div>\n                                  </div>\n                                  <div class="ms-1 mt-md-0 my-md-0 w-100">\n                                              <div class="d-flex justify-content-between align-items-center mb-1">\n                                                  <label class="fs-12px">مبلغ التبرع</label>\n                                                  <label class="fs-10px text-neutral-4">من مضاعفات الرقم ${w}</label>\n                                              </div>\n                                        <div class="AnotherAmount-container">\n                                            <div class="input-group">\n                                                <input id="amount-${qe}" name="WaqfDonationDto.Gift[${qe}].Amount" class="AnotherAmountAdd calcAmount only-number form-control border-end-0" type="text" autocomplete="off" placeholder="مبلغ اخر" inputmode="numeric" pattern="d*" maxlength="7" aria-label="أو أضف مبلغ آخر" id="anotherAmountAdd-0" value="${w}"/>\n                                                <span class="border-start-0 font-ehsan-regular border-neutral-4 fs-12px input-group-text p-2 text-neutral-4">ريال سعودي</span>\n                                            </div>\n                                        </div>\n                                    </div>\n                </div>\n            </div>\n        </div>`;R.insertAdjacentHTML("beforeend",t),document.querySelector(`[data-id="${qe}"]`).addEventListener("input",Ee),Ne(qe),document.querySelector(`#amount-${qe}`).addEventListener("change",(e=>{handleAnotherAmount(e.target)})),document.querySelector(`#amount-${qe}`).addEventListener("input",(e=>{Number(e.target.value)||(e.target.value=w,handleAnotherAmount(e.target))})),a([document.querySelector(`#gifteeBoxDetails-${qe}`).querySelector(".mobile-container > .country-code")]),0!==qe&&($e(),xe(qe),document.querySelector(`#GifteeName-${qe}`).focus(),x.innerHTML=`تم إضافة عنصر جديد إلى قائمة المُتَبَرَّع عنهم. (${document.querySelectorAll(".gifteeBoxDetails").length} / 5)`),5==document.querySelectorAll(".gifteeBoxDetails").length&&(J.disabled=!0),qe++}))},Ie=e=>{fe($.value);const t=document.querySelectorAll(".gifteeBoxDetails");e?t.forEach((e=>{xe(e.dataset.id)})):t.forEach((e=>{Be(e.dataset.id)}))},xe=e=>{re.addField(`#GifteeName-${e}`,[se()],{errorsContainer:`#GifteeName-${e}-error`}).addField(`#gifteeNumber-${e}`,[se(),ce("^(5)[0-9]{8}$","رقم الجوال غير صحيح")],{errorsContainer:`#GifteeMobileNumber-${e}-error`}),document.querySelector(`#country-code-${e}`).addEventListener("cahnge",(function(t){document.getElementById(`gifteeNumber-${e}`).value="",re.removeField(`#gifteeNumber-${e}`),"1"==document.querySelector(`#country-code-${e}`).value?re.addField(`#gifteeNumber-${e}`,[se(),ce("^(5)[0-9]{8}$","رقم الجوال غير صحيح")],{errorsContainer:`#GifteeMobileNumber-${e}-error`}):re.addField(`#gifteeNumber-${e}`,[se(),ue(5,"رقم الجوال لايقل عن 5 أرقام كحد أدنى")],{errorsContainer:`#GifteeMobileNumber-${e}-error`})}))},Be=e=>{re.removeField(`#GifteeName-${e}`).removeField(`#gifteeNumber-${e}`)},Ne=e=>{document.querySelector(`#gifteeBoxDetails-${e}`).querySelector(".input-gifteeNumber").setAttribute("id",`gifteeNumber-${e}`),document.querySelector(`#gifteeBoxDetails-${e}`).querySelector(".country-code").setAttribute("id",`country-code-${e}`),document.querySelector(`#gifteeBoxDetails-${e}`).querySelector(".country-code").setAttribute("name",`WaqfDonationDto.Gift[${e}].CountryCodeId`)};J.addEventListener("click",Le),Le();const Ae=()=>{const e=[];return document.querySelectorAll(".gifteeBoxDetails").forEach((t=>{e.push({GifteeName:t.querySelector(".input-gifteeName").value,CountryCodeId:t.querySelector(".country-code").value,GifteeMobile:t.querySelector(".input-gifteeNumber").value,Stocks:parseInt(t.querySelector(".calcQuantity").value),Amount:parseInt(t.querySelector(".calcAmount").value),CountryCode:t.querySelector(".country-code").dataset.code.split("+")[0],SenderName:O.value})})),e};window.deleteCustomization=(e,t)=>{fe(parseInt($.value)-parseInt(t)),document.getElementById(`item-${e}`).remove(),document.querySelectorAll(".customization-data").length<5&&(oe.disabled=!1),0==document.querySelectorAll(".advanced-customization-item").length&&X.classList.add("d-none")};const De=()=>{const e=[];return document.querySelectorAll(".customization-data").forEach((t=>{e.push(JSON.parse(t.value))})),e};document.getElementById("add-customization").addEventListener("click",(e=>{e.preventDefault(),(e=>{if(pe(document.querySelector("input[name='WaqfDonationDto.WaqfAllocationType.item']:checked"),K)){X.classList.remove("d-none");const t={WaqfAllocationType:parseInt(document.querySelector("input[name='WaqfDonationDto.WaqfAllocationType.item']:checked").value),Stocks:parseInt(document.getElementById("stock-customization").value),Amount:parseInt(document.getElementById("amount-customization").value),WaqfProjectId:""!=N.value?parseInt(N.value):null,RegionId:""!=A.value?parseInt(A.value):null,WaqfOrganizationId:""!=B.value?parseInt(B.value):null};let n="";n=2==document.querySelector("input[name='WaqfDonationDto.WaqfAllocationType.item']:checked").value?""!=A.value&&""!=N.value?A.tomselect.control.innerText+" - "+N.tomselect.control.innerText:""!=A.value?A.tomselect.control.innerText:N.tomselect.control.innerText:B.tomselect.control.innerText;const a=()=>1==t.Stocks?"وحدة وقفية واحدة":2==t.Stocks?"وحدتان وقفيتان":t.Stocks>=3&&t.Stocks<11?`${t.Stocks} وحدات`:t.Stocks>=11?`${t.Stocks} وحدة`:void 0;X.innerHTML+=`<div class="card border-0 w-100 d-flex justify-content-between flex-row col-10 p-1 px-2 rounded-4 mb-2 align-items-center advanced-customization-item" id="item-${e}" data-index="${e}">\n    <input class="customization-data" hidden value='${JSON.stringify(t)}'/>\n    <div>\n    <label class="mb-1 text-color-42 font-ehsan-bold fs-12px">التخصيص : ${n}</label>\n    <div class="d-flex flex-row font-ehsan-semibold">\n    <label class="fs-10px text-muted opacity-75 me-3">عدد الوحدات : ${a()}</label>\n    <label class="fs-10px text-muted opacity-75">المبلغ : ${t.Amount} ريال سعودي</label>\n    </div>\n    </div>\n    <button type="button" id="delete-item-${e}" onclick="deleteCustomization(${e},${t.Stocks})" class="btn p-0 text-grey-2"><img alt="" class="w-18px" src="../../ehsan-ui/images/icons-collections/trash-icon.svg"/></button>\n    </div>`,fe(parseInt($.value)+t.Stocks),5==document.querySelectorAll(".customization-data").length&&(oe.disabled=!0),le.hide()}})(document.querySelectorAll(".advanced-customization-item").length)})),he(),D.get("org")&&""!=D.get("org")&&(document.getElementById("organization").checked=!0,document.getElementById("advanced-customization").click(),"-1"!=B.dataset.selected&&(B.tomselect.addItem(B.dataset.selected),le.show())),Y.addEventListener("change",(e=>{handleAnotherAmount(e.target)}));const $e=()=>{let e=0,t=0;document.querySelectorAll(".gifteeBoxDetails").forEach((n=>{e+=parseInt(document.querySelector(`input[name='WaqfDonationDto.Gift[${n.dataset.id}].Stocks']`).value),t+=parseInt(document.querySelector(`input[name='WaqfDonationDto.Gift[${n.dataset.id}].Amount']`).value)})),fe(e),Q.insertAdjacentHTML("beforeend",`<input hidden name="WaqfDonationDto.Stocks" value = ${e}>`),Q.insertAdjacentHTML("beforeend",`<input hidden name="WaqfDonationDto.Amount" value = ${t}>`)};document.getElementById("customization-model").addEventListener("hidden.bs.modal",(()=>{B.tomselect.clear(),N.tomselect.clear(),A.tomselect.clear(),ee.value=10,Y.value=10*w,document.querySelector("input[name='WaqfDonationDto.WaqfAllocationType.item']").checked=!0})),document.getElementById("advanced-customization").addEventListener("change",(e=>{e.target.checked&&H.classList.add("d-none")})),document.getElementById("all").addEventListener("change",(e=>{e.target.checked&&H.classList.remove("d-none")}));
//# sourceMappingURL=waqfService.js.map
